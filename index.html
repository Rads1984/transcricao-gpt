<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TranscriÃ§Ã£o Inteligente com GPT</title>
  <script src="https://cdn.jsdelivr.net/npm/@whispercpp/whisper-wasm@latest/dist/whisper-wasm.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      padding: 20px;
    }
    .container {
      max-width: 960px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input[type="file"], select, textarea, button {
      width: 100%;
      margin-top: 10px;
      margin-bottom: 20px;
    }
    .preview-models {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-top: 20px;
    }
    .model-view {
      flex: 1;
      min-width: 280px;
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 5px;
      background: #fafafa;
    }
    .correction-options, .resumo-section {
      margin-top: 30px;
      background: #f0f8ff;
      padding: 20px;
      border-radius: 10px;
    }
    .correction-options h3, .resumo-section h3 {
      margin-top: 0;
    }
    .tag-selector {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .tag-selector label {
      background: #dfefff;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
    }
    .tag-selector input {
      margin-right: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¤ TranscriÃ§Ã£o Inteligente com GPT</h1>

    <label for="audioUpload">ğŸ“¤ Envie seu Ã¡udio:</label>
    <input type="file" id="audioUpload" accept="audio/*">
    <button onclick="transcreverAudio()">ğŸ™ï¸ Iniciar TranscriÃ§Ã£o</button>

    <label for="fontSelect">ğŸ…°ï¸ Escolha a fonte:</label>
    <select id="fontSelect" onchange="aplicarEstilo()">
      <option value="Arial">Arial</option>
      <option value="Calibri">Calibri</option>
      <option value="Times New Roman">Times New Roman</option>
    </select>

    <label for="fontSize">ğŸ”  Tamanho da fonte:</label>
    <select id="fontSize" onchange="aplicarEstilo()">
      <option value="14px">Pequeno</option>
      <option value="16px" selected>MÃ©dio</option>
      <option value="18px">Grande</option>
    </select>

    <label for="outputText">ğŸ“ TranscriÃ§Ã£o Corrigida:</label>
    <textarea id="outputText" rows="10"></textarea>

    <button onclick="copyText()">ğŸ“‹ Copiar</button>
    <button onclick="exportDoc()">ğŸ“„ Exportar como Word</button>
    <button onclick="preparePrompt()">ğŸ¤– Enviar para ChatGPT</button>

    <div class="preview-models">
      <div class="model-view" id="model1">
        <h3>Modelo 1 â€“ TranscriÃ§Ã£o na Ãntegra (Texto Puro)</h3>
        <p>Exibe todo o conteÃºdo sem ediÃ§Ã£o. Ideal para quem deseja revisar cada fala ou usar o material cru.</p>
      </div>
      <div class="model-view" id="model2">
        <h3>Modelo 2 â€“ Texto Organizado com Imagens</h3>
        <p>Adiciona estrutura com tÃ­tulos, subtÃ­tulos e ilustraÃ§Ãµes compatÃ­veis com o tema. Pode incluir emojis e Ã­cones explicativos.</p>
      </div>
      <div class="model-view" id="model3">
        <h3>Modelo 3 â€“ Resumo Personalizado</h3>
        <p id="resumoOutput">VocÃª escolhe os tÃ³picos importantes (ex: definiÃ§Ã£o, conduta, diagnÃ³stico) e o site monta um resumo com base nisso.</p>
      </div>
    </div>

    <div class="resumo-section">
      <h3>ğŸ“‹ Selecione os tÃ³picos que deseja incluir no resumo:</h3>
      <div class="tag-selector">
        <label><input type="checkbox" value="DefiniÃ§Ã£o">DefiniÃ§Ã£o</label>
        <label><input type="checkbox" value="Etiologia">Etiologia</label>
        <label><input type="checkbox" value="DiagnÃ³stico">DiagnÃ³stico</label>
        <label><input type="checkbox" value="Tratamento">Tratamento</label>
        <label><input type="checkbox" value="Conduta">Conduta</label>
        <label><input type="checkbox" value="Dica de Prova">Dica de Prova</label>
      </div>
      <button onclick="gerarResumo()">ğŸ“Œ Gerar Resumo</button>
    </div>

    <div class="correction-options">
      <h3>âœï¸ CorreÃ§Ã£o Gramatical (3 opÃ§Ãµes):</h3>
      <ol>
        <li><strong>AutomÃ¡tica via API GPT-4:</strong> Se vocÃª inserir sua chave da OpenAI, o texto serÃ¡ corrigido automaticamente.</li>
        <li><strong>Manual com ChatGPT:</strong> Use o botÃ£o â€œEnviar para ChatGPTâ€ para colar o texto com um prompt inteligente.</li>
        <li><strong>CorreÃ§Ã£o gratuita no navegador:</strong> Com LanguageTool ou extensÃµes integradas ao navegador (ortografia + pontuaÃ§Ã£o).</li>
      </ol>
    </div>
  </div>

  <script>
    function copyText() {
      const text = document.getElementById("outputText");
      text.select();
      document.execCommand("copy");
      alert("Texto copiado!");
    }

    function exportDoc() {
      const text = document.getElementById("outputText").value;
      const blob = new Blob([text], { type: 'application/msword' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "transcricao.doc";
      a.click();
    }

    function preparePrompt() {
      const text = document.getElementById("outputText").value;
      const prompt = `Organize e corrija o texto a seguir com pontuaÃ§Ã£o, parÃ¡grafos, gramÃ¡tica e coerÃªncia:\n\n${text}`;
      navigator.clipboard.writeText(prompt);
      alert("Prompt copiado! Cole no ChatGPT Plus para organizar.");
    }

    function aplicarEstilo() {
      const font = document.getElementById("fontSelect").value;
      const size = document.getElementById("fontSize").value;
      const textarea = document.getElementById("outputText");
      textarea.style.fontFamily = font;
      textarea.style.fontSize = size;
    }

    async function transcreverAudio() {
      alert("TranscriÃ§Ã£o offline via Whisper ainda serÃ¡ configurada com modelo wasm.");
    }

    function gerarResumo() {
      const texto = document.getElementById("outputText").value;
      const checkboxes = document.querySelectorAll('.tag-selector input[type="checkbox"]:checked');
      const topicosSelecionados = Array.from(checkboxes).map(cb => cb.value);

      if (!texto.trim()) {
        alert("VocÃª precisa ter um texto transcrito primeiro.");
        return;
      }

      if (topicosSelecionados.length === 0) {
        alert("Selecione ao menos um tÃ³pico para gerar o resumo.");
        return;
      }

      const linhas = texto.split("\n");
      const resumo = linhas.filter(linha => {
        return topicosSelecionados.some(topico => linha.toLowerCase().includes(topico.toLowerCase()));
      });

      const saida = resumo.length > 0 ? resumo.join("\n") : "Nenhum trecho relacionado aos tÃ³picos selecionados foi encontrado.";
      document.getElementById("resumoOutput").textContent = saida;
    }
  </script>
</body>
</html>
